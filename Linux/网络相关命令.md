# 网络相关

## 临时添加/删除默认网关

```shell
route add default gw 172.28.1.1
route del default gw 172.28.1.1
```

## 配置http、https、ftp代理

```shell

export http_proxy=http://username:password@ip:port
export https_proxy=${http_proxy}
export ftp_proxy=${http_proxy}
```

## 配置DNS服务器

```shell
vim /etc/resolv.conf
```

添加相应DNS服务器

```conf
nameserver 172.28.1.12
```

## 配置yum代理

### 临时配置（只对当前会话生效）

按上文配置http、https代理即可

### 永久配置

1. 编辑yum配置文件：

    ```shell
    vim /etc/yum.conf
    ```

1. 在文件的末尾添加：

    ```conf
    proxy=http://proxy.example.com:port
    proxy_username=your_username      # 可选
    proxy_password=your_password      # 可选
    ```

## rp_filter设置

### 查看当前`rp_filter`设置

```shell
cat /proc/sys/net/ipv4/conf/all/rp_filter
cat /proc/sys/net/ipv4/conf/default/rp_filter
cat /proc/sys/net/ipv4/conf/eth0/rp_filter
```

+ `0`：关闭（No source validation）
+ `1`：开启严格模式（Strict mode，默认）
+ `2`：宽松模式（Loose mode）

### 关闭rp_filter

+ 临时关闭

    ```shell
    for iface in $(ls /proc/sys/net/ipv4/conf/); do
        echo "Setting rp_filter=0 for ${iface}"
        echo 0 | sudo tee /proc/sys/net/ipv4/conf/${iface}/rp_filter > /dev/null
    done
    ```

+ 永久关闭，重启生效

    ```shell
    rm -rf /etc/sysctl.d/99-disable-rp_filter.conf
    for iface in $(ls /proc/sys/net/ipv4/conf/); do
        echo -e "net.ipv4.conf.${iface}.rp_filter = 0" >> /etc/sysctl.d/99-disable-rp_filter.conf
    done
    ```
