# ffprobe常用命令

## 打印ts流中的pts和dts

+ **注意**：生成的`csv`的直接用`excel`打不开，因为csv文件头加了两个特殊的字节`0xFF,0xFE`，将其删掉即可。
+ **注意**：输出的`time_base`是`90k`，示例用`90k`表示

### 解复用

```shell
ffprobe -v error -show_packets -of csv=p=0 input.ts > output.csv
```

生成的csv格式为

```csv
# media_type, stream_index, pts(90k), pts_time(s), dts(90k), dts_time(s), duration(90k), duration_time(s), size, pos, flags
audio,1,2522987422,28033.193578,2522987422,28033.193578,2160,0.024000,768,3196,K__,MPEGTS Stream ID,192
video,0,2522994775,28033.275278,2522991772,28033.241911,1501,0.016678,2779,188,___,MPEGTS Stream ID,224
audio,1,2522989582,28033.217578,2522989582,28033.217578,2160,0.024000,768,59596,K__,MPEGTS Stream ID,192
audio,1,2522991742,28033.241578,2522991742,28033.241578,2160,0.024000,768,60536,K__,MPEGTS Stream ID,192
video,0,2522996277,28033.291967,2522993273,28033.258589,1501,0.016678,2934,4136,___,MPEGTS Stream ID,224
video,0,2523009790,28033.442111,2522994775,28033.275278,1501,0.016678,50838,7520,___,MPEGTS Stream ID,224
video,0,2523011292,28033.458800,2522996276,28033.291956,1501,0.016678,36687,61476,___,MPEGTS Stream ID,224
video,0,2523003784,28033.375378,2522997778,28033.308644,1501,0.016678,11804,99264,___,MPEGTS Stream ID,224
video,0,2523005286,28033.392067,2522999279,28033.325322,1501,0.016678,13410,111484,___,MPEGTS Stream ID,224
audio,1,2522993902,28033.265578,2522993902,28033.265578,2160,0.024000,768,132352,K__,MPEGTS Stream ID,192
audio,1,2522996062,28033.289578,2522996062,28033.289578,2160,0.024000,768,133292,K__,MPEGTS Stream ID,192
audio,1,2522998222,28033.313578,2522998222,28033.313578,2160,0.024000,768,134232,K__,MPEGTS Stream ID,192
video,0,2523000781,28033.342011,2523000781,28033.342011,1501,0.016678,2889,125396,___,MPEGTS Stream ID,224
audio,1,2523000382,28033.337578,2523000382,28033.337578,2160,0.024000,768,139496,K__,MPEGTS Stream ID,192
video,0,2523002283,28033.358700,2523002282,28033.358689,1501,0.016678,3450,128780,___,MPEGTS Stream ID,224
...
```

### 解码

```shell
ffprobe -v error -show_frames -of csv=p=0 input.ts > output.csv
```

生成的csv格式为

```csv
# media_type, stream_index, pts(90k), pts_time(s), dts(90k), dts_time(s)
audio,1,1,2523037102,28033.745578,2523037102,28033.745578,2523037102,28033.745578,2160,0.024000,637696,768,s16p,1152,2,stereo
audio,1,1,2523039262,28033.769578,2523039262,28033.769578,2523039262,28033.769578,2160,0.024000,764596,768,s16p,1152,2,stereo
audio,1,1,2523041422,28033.793578,2523041422,28033.793578,2523041422,28033.793578,2160,0.024000,768732,768,s16p,1152,2,stereo
audio,1,1,2523043582,28033.817578,2523043582,28033.817578,2523043582,28033.817578,2160,0.024000,769672,768,s16p,1152,2,stereo
video,0,1,2523045826,28033.842511,2523047327,28033.859189,2523045826,28033.842511,1501,0.016678,397808,157269,1920,1080,0,0,0,0,yuv420p,1:1,I,1,1,0,tv,bt709,bt709,bt709,left
audio,1,1,2523045742,28033.841578,2523045742,28033.841578,2523045742,28033.841578,2160,0.024000,773808,768,s16p,1152,2,stereo
audio,1,1,2523047902,28033.865578,2523047902,28033.865578,2523047902,28033.865578,2160,0.024000,777756,768,s16p,1152,2,stereo
video,0,0,2523048829,28033.875878,2523050330,28033.892556,2523048829,28033.875878,1501,0.016678,765536,3083,1920,1080,0,0,0,0,yuv420p,1:1,B,1,1,0,tv,bt709,bt709,bt709,left
video,0,0,2523051832,28033.909244,2523053333,28033.925922,2523051832,28033.909244,1501,0.016678,731696,17938,1920,1080,0,0,0,0,yuv420p,1:1,B,1,1,0,tv,bt709,bt709,bt709,left
audio,1,1,2523050062,28033.889578,2523050062,28033.889578,2523050062,28033.889578,2160,0.024000,856152,768,s16p,1152,2,stereo
video,0,0,2523054835,28033.942611,2523056336,28033.959289,2523054835,28033.942611,1501,0.016678,774748,2876,1920,1080,0,0,0,0,yuv420p,1:1,B,1,1,0,tv,bt709,bt709,bt709,left
video,0,0,2523057838,28033.975978,2523059339,28033.992656,2523057838,28033.975978,1501,0.016678,638824,51066,1920,1080,0,0,0,0,yuv420p,1:1,P,1,1,0,tv,bt709,bt709,bt709,left
audio,1,1,2523052222,28033.913578,2523052222,28033.913578,2523052222,28033.913578,2160,0.024000,911236,768,s16p,1152,2,stereo
audio,1,1,2523054382,28033.937578,2523054382,28033.937578,2523054382,28033.937578,2160,0.024000,912176,768,s16p,1152,2,stereo
audio,1,1,2523056542,28033.961578,2523056542,28033.961578,2523056542,28033.961578,2160,0.024000,913116,768,s16p,1152,2,stereo
audio,1,1,2523058702,28033.985578,2523058702,28033.985578,2523058702,28033.985578,2160,0.024000,914056,768,s16p,1152,2,stereo
video,0,0,2523060841,28034.009344,2523062342,28034.026022,2523060841,28034.009344,1501,0.016678,902964,4156,1920,1080,0,0,0,0,yuv420p,1:1,B,1,1,0,tv,bt709,bt709,bt709,left
...
```
